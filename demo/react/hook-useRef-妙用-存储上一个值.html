<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>react demo</title>
    <script
      crossorigin
      src="https://unpkg.com/react@17/umd/react.development.js"
    ></script>
    <script
      crossorigin
      src="https://unpkg.com/react-dom@17/umd/react-dom.development.js"
    ></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-core/5.8.23/browser.min.js"></script>
  </head>
  <body>
    <div id="app"></div>

    <script type="text/babel">

      const { useState, useRef, useEffect } = React;

      const App = () => {
        const [count, setCount] = useState(0);
        const preCount = useRef();

        // 触发时机：每次页面render完才会执行
        useEffect(() => {
          // count读取的是最新的值
          console.log(`count的值为：${count}`)

          // 等到页面render完成后，再赋值不会触发render，所以页面上显示的还是上一次的值
          preCount.current = count;
        });

        return (
                <div>
                  {console.log("in render")}
                  <div>precount:{preCount.current}</div>
                  <p>you clicked {count} times</p>
                  <button onClick={() => setCount(count + 1)}>Click Me</button>
                </div>
        );
      };


      ReactDOM.render(<App />, document.getElementById("app"));
    </script>
  </body>
</html>
